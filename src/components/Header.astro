---
import { SITE_TITLE, LINKEDIN_URL, INSTAGRAM_URL } from '../consts';
import HeaderLink from './HeaderLink.astro';
---

<header class="sticky top-0 z-50 w-full border-b border-gray-200/80 bg-white/80 backdrop-blur-md">
  <div class="mx-auto max-w-7xl">
    <nav class="flex h-16 items-center justify-between px-4 sm:px-6 lg:px-8">
      <!-- Logo -->
      <div class="flex items-center">
        <a href="/" class="text-xl truncate font-thin text-gray-900 hover:text-gray-700 transition-colors">
          {SITE_TITLE}
        </a>
      </div>

      <!-- Navigation Links (Desktop) -->
      <div class="hidden md:flex items-center space-x-8">
        <HeaderLink href="/" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Início</HeaderLink>
        <HeaderLink href="/blog" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Blog</HeaderLink>
        <HeaderLink href="/gallery" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Galeria</HeaderLink>
        <HeaderLink href="/about" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Sobre</HeaderLink>
        <HeaderLink href="/publications" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Publicações</HeaderLink>
        <HeaderLink href="/contato" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">Contato</HeaderLink>
      </div>

      <!-- Social Links (Desktop) -->
      <div class="hidden md:flex items-center space-x-4">
        <a href={INSTAGRAM_URL} target="_blank" class="p-2 text-gray-500 hover:text-gray-700 transition-colors" rel="noopener noreferrer">
          <span class="sr-only">Instagram</span>
          <svg fill="currentColor" width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M11.469 5C7.918 5 5 7.914 5 11.469v9.063C5 24.082 7.914 27 11.469 27h9.063C24.082 27 27 24.086 27 20.531v-9.063C27 7.918 24.086 5 20.531 5h-9.063zM21.906 9.188a.906.906 0 100 1.813.906.906 0 000-1.813zM16 10a6 6 0 100 12 6 6 0 000-12z"/></svg>
        </a>
        <a href={LINKEDIN_URL} target="_blank" class="p-2 text-gray-500 hover:text-gray-700 transition-colors" rel="noopener noreferrer">
          <span class="sr-only">LinkedIn</span>
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z" clip-rule="evenodd"/></svg>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button id="mobile-menu-btn" type="button"
          class="p-2 text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500"
          aria-expanded="false" aria-controls="mobile-menu">
          <span class="sr-only">Abrir menu</span>
          <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
        </button>
      </div>
    </nav>
  </div>
</header>

<!-- Mobile Menu: move outside header stacking, raise z-index, solid bg, full-screen -->
<div id="mobile-menu"
  class="md:hidden fixed inset-0 z-[9999] bg-white backdrop-blur-md flex flex-col items-stretch justify-center px-8 py-10 space-y-2
         transition-opacity duration-200 opacity-0 pointer-events-none">
  <!-- Bigger, full-width tap targets -->
  <HeaderLink href="/"            class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Início</HeaderLink>
  <HeaderLink href="/blog"        class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Blog</HeaderLink>
  <HeaderLink href="/gallery"     class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Galeria</HeaderLink>
  <HeaderLink href="/about"       class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Sobre</HeaderLink>
  <HeaderLink href="/publications"class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Publicações</HeaderLink>
  <HeaderLink href="/contato"     class="block w-full text-center py-4 text-lg font-semibold text-gray-900 hover:bg-gray-50">Contato</HeaderLink>

  <div class="flex items-center justify-center space-x-6 pt-6">
    <a href={INSTAGRAM_URL} target="_blank" rel="noopener noreferrer" class="p-2 text-gray-500 hover:text-gray-700 transition-colors">
      <span class="sr-only">Instagram</span>
      <svg fill="currentColor" width="22" height="22" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M11.469 5C7.918 5 5 7.914 5 11.469v9.063C5 24.082 7.914 27 11.469 27h9.063C24.082 27 27 24.086 27 20.531v-9.063C27 7.918 24.086 5 20.531 5h-9.063zM21.906 9.188a.906.906 0 100 1.813.906.906 0 000-1.813zM16 10a6 6 0 100 12 6 6 0 000-12z"/></svg>
    </a>
    <a href={LINKEDIN_URL} target="_blank" rel="noopener noreferrer" class="p-2 text-gray-500 hover:text-gray-700 transition-colors">
      <span class="sr-only">LinkedIn</span>
      <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z" clip-rule="evenodd"/></svg>
    </a>
  </div>
</div>

<script is:inline>
  const btn = document.getElementById('mobile-menu-btn');
  const menu = document.getElementById('mobile-menu');
  const html = document.documentElement;
  let open = false;

  function openMenu() {
    open = true;
    btn.setAttribute('aria-expanded', 'true');
    menu.classList.remove('opacity-0', 'pointer-events-none');
    menu.classList.add('opacity-100');
    html.classList.add('overflow-hidden'); // lock scroll
  }

  function closeMenu() {
    open = false;
    btn.setAttribute('aria-expanded', 'false');
    menu.classList.add('opacity-0', 'pointer-events-none');
    menu.classList.remove('opacity-100');
    html.classList.remove('overflow-hidden');
  }

  btn.addEventListener('click', () => (open ? closeMenu() : openMenu()));

  // Close menu on link click (touch-safe)
  menu.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', closeMenu);
  });

  // Optional: close on Escape
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && open) closeMenu();
  });
</script>
